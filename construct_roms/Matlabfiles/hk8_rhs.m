function f = hk8_rhs(x,a,s,k,R) 
% Vars: x = [p0,1 p0,3 p1,1 p1,2 t0,2 t0,4 t1,1 t1,2] 
 
r = R^(1/2);

f = [-x(1)*s/r - 3*a(3)*a(4)*k*x(3)*x(4)/(4*a(1)),...
 -9*x(2)*s/r + a(3)*a(4)*k*x(3)*x(4)/(4*a(2)),...
 -x(3)*s*(k^2 + 1)/r + (a(1)*a(4)*k*x(1)*x(4)*(k^2 + 3)/(2*a(3)) - 3*a(2)*a(4)*k*x(2)*x(4)*(k^2 - 5)/(2*a(3)))/(k^2 + 1) + a(7)*k*s*x(7)/(a(3)*(k^2 + 1)),...
 -x(4)*s*(k^2 + 4)/r + (-a(1)*a(3)*k^3*x(1)*x(3)/(2*a(4)) + 3*a(2)*a(3)*k*x(2)*x(3)*(k^2 - 8)/(2*a(4)))/(k^2 + 4) - a(8)*k*s*x(8)/(a(4)*(k^2 + 4)),...
a(3)*a(7)*k*x(3)*x(7)/(2*a(5)) - 4*x(5)/r,...
 -a(4)*a(8)*k*x(4)*x(8)/a(6) - 16*x(6)/r,...
 -a(1)*a(8)*k*x(1)*x(8)/(2*a(7)) + 3*a(2)*a(8)*k*x(2)*x(8)/(2*a(7)) - a(3)*a(5)*k*x(3)*x(5)/a(7) + a(3)*k*x(3)/a(7) + x(7)*(-k^2 - 1)/r,...
 a(1)*a(7)*k*x(1)*x(7)/(2*a(8)) - 3*a(2)*a(7)*k*x(2)*x(7)/(2*a(8)) + 2*a(4)*a(6)*k*x(4)*x(6)/a(8) - a(4)*k*x(4)/a(8) + x(8)*(-k^2 - 4)/r];